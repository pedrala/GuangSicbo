{"remainingRequest":"/Users/crazycapital/Downloads/GuangGame/gsicboDeliver201909302/sources_20190930/gsicbo-client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/crazycapital/Downloads/GuangGame/gsicboDeliver201909302/sources_20190930/gsicbo-client/src/App.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/crazycapital/Downloads/GuangGame/gsicboDeliver201909302/sources_20190930/gsicbo-client/src/App.vue","mtime":1567760082000},{"path":"/Users/crazycapital/Downloads/GuangGame/gsicboDeliver201909302/sources_20190930/gsicbo-client/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/crazycapital/Downloads/GuangGame/gsicboDeliver201909302/sources_20190930/gsicbo-client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/crazycapital/Downloads/GuangGame/gsicboDeliver201909302/sources_20190930/gsicbo-client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { flatMap } from 'rxjs/operators'\r\nimport { mapState, mapMutations } from 'vuex';\r\nimport Drawer from './components/Drawer.vue';\r\nimport Appbar from './components/Appbar.vue';\r\nimport Bonus from './components/Bonus.vue';\r\nimport Referral from './components/Referral.vue';\r\nimport Howto from './components/HowToModal.vue';\r\nimport { throwError } from 'rxjs';\r\n\r\nconst LANDING_STATIC = 1284;\r\nconst LANDING_MOBILE = 984;\r\nconst SICBO_MOBILE_WIDTH = 1024;\r\nconst SICBO_MOBILE_HEIGHT = 680;\r\n\r\nexport default {\r\n  /**\r\n   * Data\r\n   */\r\n  data() {\r\n    return {\r\n      initialized: false,\r\n      musicSrc: '/music/music.mp3',\r\n      isTokenChanged: false,\r\n      isLangChanged: false,\r\n      showBonus: false,\r\n      showReferral: false,\r\n      showHowto: false,\r\n      isModal: false,\r\n    }\r\n  },\r\n  /**\r\n   * Computed\r\n   */\r\n  computed: mapState({\r\n    isDrawer(state) {\r\n      return state.common.drawerMode !== 'static' && state.common.drawerState === 'open';\r\n    },\r\n    /**\r\n     * Contents 패딩 영역의 css class\r\n     */\r\n    classPadding(state) {\r\n      if (state.common.drawerMode === 'static') return 'padding static';\r\n      if (state.common.drawerState === 'open') {\r\n        return 'padding-close';\r\n      }\r\n      return 'padding-close';\r\n    },\r\n    /**\r\n     * Navigation drawer의 css class\r\n     */\r\n    classDrawer(state) {\r\n      if (state.common.drawerMode === 'static') return 'static';\r\n\r\n      if (state.common.drawerMode === 'overlap' && state.common.appbarMode === 'mobile') {\r\n        if (state.common.drawerState === 'close') {\r\n          if (!this.initialized) {\r\n            this.initialized = true;\r\n            return 'over-tall close-without-ani';\r\n          }\r\n          \r\n          return 'over-tall close';\r\n        } else if (state.common.drawerState === 'close-without-ani') {\r\n          return 'over-tall close-without-ani';  \r\n        }\r\n        return 'over-tall open';\r\n      }\r\n      \r\n      if (state.common.drawerState === 'close') {\r\n        return 'over-short close';  \r\n      } else if (state.common.drawerState === 'close-without-ani') {\r\n        return 'over-short close-without-ani'; \r\n      }\r\n      return 'over-short open';  \r\n    },\r\n    /**\r\n     * Navigation drawer의 뒤에 깔리는 반투명 div의 css class\r\n     */\r\n    classDrawerScrim(state) {\r\n      if (state.common.drawerMode === 'static') {\r\n        document.body.style.overflow = '';\r\n        return '';\r\n      }\r\n\r\n      if (state.common.drawerState === 'open') {\r\n        document.body.style.overflow = 'hidden';\r\n        return 'open';\r\n      }\r\n\r\n      document.body.style.overflow = '';\r\n      return 'close';\r\n    },\r\n    /**\r\n     * Contents 영역의 css class\r\n     */\r\n    classContents(state) {\r\n      if (state.common.drawerMode === 'static') return `pc`;\r\n      if (state.common.drawerState === 'open') {\r\n        return `${state.common.appbarMode}`;  \r\n      }\r\n      return `${state.common.appbarMode}`;\r\n    },\r\n    /**\r\n     * \r\n     */\r\n    userName(state) {\r\n      if (!state.common.account.name) {\r\n        return ''\r\n      }\r\n      return state.common.account.name;\r\n    }\r\n  }),\r\n  /**\r\n   * Created\r\n   */\r\n  created() {\r\n    if (this.$route.query.ref && this.$route.query.ref.length <= 12) {\r\n      localStorage.setItem('GuangGame.Referral', this.$route.query.ref);\r\n    }\r\n    window.addEventListener('resize', this.onResize);\r\n    this.showHowtoAtFirst(); //\r\n  },\r\n  /**\r\n   * Destroy\r\n   */\r\n  destroyed() {\r\n    window.removeEventListener('resize', this.onResize);\r\n  },\r\n  /**\r\n   * Mounted\r\n   */\r\n  mounted () {\r\n    this.onResize();\r\n    this.login();\r\n  },\r\n  /**\r\n   * Method\r\n   */\r\n  methods: {\r\n    /**\r\n     * vuex store\r\n     */\r\n    ...mapMutations([\r\n      'setAppbarMode',\r\n      'setDrawerState',\r\n      'setDrawerMode',\r\n      'setAccount',\r\n      'setEosBalance',\r\n      'setTazBalance',\r\n      'setTazchipBalance',\r\n      'setUserData'\r\n    ]),\r\n    /**\r\n     * 브라우져 화면 크기에 변화가 생겼을 때 호출 되는 이벤트 콜백 함수\r\n     */\r\n    onResize() {\r\n      if (this.$route.name === 'sicbo') {\r\n        if (window.innerWidth < SICBO_MOBILE_WIDTH || window.innerHeight < SICBO_MOBILE_HEIGHT) {\r\n          this.setAppbarMode('mobile');\r\n        } else {\r\n          this.setAppbarMode('pc');\r\n        }\r\n        this.setDrawerMode('overlap');\r\n        this.setDrawerState('close');\r\n        this.$eventBus.$emit('resize', {w: window.innerWidth, h: window.innerHeight});\r\n      } else {\r\n        if (window.innerWidth >= LANDING_STATIC) {\r\n          this.setAppbarMode('pc');\r\n          this.setDrawerMode('static');\r\n          this.setDrawerState('open');\r\n        } else if (window.innerWidth >= LANDING_MOBILE) {\r\n          this.setAppbarMode('pc');\r\n          this.setDrawerMode('overlap');\r\n          this.setDrawerState('close');\r\n        } else {\r\n          this.setAppbarMode('mobile');\r\n          this.setDrawerMode('overlap');\r\n          this.setDrawerState('close');\r\n        }\r\n      }\r\n    },\r\n    /**\r\n     * Navigation drawer을 닫는다.\r\n     */\r\n    closeDrawer() {\r\n      this.setDrawerState('close');\r\n    },\r\n    changeLang(langToChange) {\r\n      console.log(langToChange);\r\n      if (this.$i18n.locale !== langToChange) {\r\n        if (!this.$loadedLanguages[langToChange]) {\r\n          return import(/* webpackChunkName: \"lang-[request]\" */ `@/languages/${langToChange}`).then(msgs => {\r\n            this.$i18n.setLocaleMessage(langToChange, msgs.default)\r\n            this.$loadedLanguages[langToChange] = msgs;\r\n            this.$i18n.locale = langToChange;\r\n            localStorage.setItem('GuangGame.Language', langToChange);\r\n            this.isLangChanged = !this.isLangChanged;\r\n          })\r\n        }\r\n        this.$i18n.locale = langToChange;\r\n        localStorage.setItem('GuangGame.Language',langToChange)\r\n        this.isLangChanged = !this.isLangChanged;\r\n      }\r\n    },\r\n    /**\r\n     * Login\r\n     */\r\n    login() {\r\n      this.$chain.connect().pipe(\r\n        flatMap(connected => {\r\n          if (connected) {\r\n            return this.$chain.login()\r\n          }\r\n          return throwError(new Error('No scatter'));\r\n        })\r\n      ).subscribe(\r\n        account => {\r\n          this.setAccount(account);\r\n\r\n          this.$chain.getEosBalance(account.name).subscribe(\r\n            eosBalance => {\r\n              if (eosBalance.length > 0) {\r\n                const token = eosBalance[0].split(' ');\r\n                this.setEosBalance(Number.parseFloat(token[0]));\r\n              } else {\r\n                this.setEosBalance(0);\r\n              }\r\n            },\r\n            error => console.error(error)\r\n          );\r\n\r\n          this.$chain.getBalance('taztokenbase', account.name, 'TAZ').subscribe(\r\n            tazBalance => {\r\n              if (tazBalance.length > 0) {\r\n                const token = tazBalance[0].split(' ');\r\n                this.setTazBalance(Number.parseFloat(token[0]));\r\n              } else {\r\n                this.setTazBalance(0);\r\n              }\r\n            },\r\n            error => console.error(error)\r\n          );\r\n\r\n          this.$chain.getBalance('taztokenbase', account.name, 'TAZCHIP').subscribe(\r\n            tazchipBalance => {\r\n              if (tazchipBalance.length > 0) {\r\n                const token = tazchipBalance[0].split(' ');\r\n                this.setTazchipBalance(Number.parseFloat(token[0]));\r\n              } else {\r\n                this.setTazchipBalance(0);\r\n              }\r\n            },\r\n            error => console.error(error)\r\n          );\r\n\r\n          this.$eventBus.$emit('login');\r\n          this.$ws.connectprivateChannel(account.name);\r\n          this.fetchUserData(account.name);\r\n        },\r\n        error => {\r\n          // user rejected the provision of an Identity\r\n          // No scatter\r\n          console.error(error.message);\r\n        }\r\n      )\r\n    },\r\n    /**\r\n     * Logout\r\n     */\r\n    logout() {\r\n      this.setAccount({});\r\n      this.setEosBalance(0);\r\n      this.setTazBalance(0);\r\n      this.setTazchipBalance(0);\r\n      this.$eventBus.$emit('logout');\r\n      this.setUserData({\r\n        account: '',\r\n        vip: 0,\r\n        accumulated_bet: 0,\r\n        accumulated_prize: 0,\r\n        staked: 0,\r\n        unstaking: 0,\r\n        unstaking_requested: 0,\r\n        created: '',\r\n        updated: '',\r\n        signup_reward: 0\r\n      });\r\n    },\r\n    //\r\n    // 배경음 재생\r\n    //\r\n    playMusic() {\r\n      const isOn = localStorage.getItem('GuangGame.music');\r\n      const music = document.getElementById('music')\r\n      if(isOn === 'on') {\r\n        music.play();\r\n      } else {\r\n        music.pause();\r\n      }\r\n    },\r\n    //\r\n    // 다른 토큰이 선택됐는지 여부 확인\r\n    //\r\n    setToken() {\r\n      this.isTokenChanged = !this.isTokenChanged;\r\n    },\r\n    //\r\n    // 모달창 열림\r\n    //\r\n    showModal(target) {\r\n      this.setDrawerState('close');\r\n      this.isModal = true;\r\n      if(target === 'bonus') {\r\n        this.showBonus = true;\r\n      } else if(target === 'referral') {\r\n        this.showReferral = true;\r\n      } else {\r\n        this.showHowto = true;\r\n      }\r\n    },\r\n    //\r\n    // 모달창 닫음\r\n    //\r\n    closeModal() {\r\n      this.isModal = false;\r\n      this.showBonus = false;\r\n      this.showReferral = false;\r\n      this.showHowto = false;\r\n    },\r\n    /**\r\n     * 서버로부터 사용자 정보를 조회한다.\r\n     */   \r\n    fetchUserData(account) {\r\n      fetch(`${this.$REST_API_SERVER}/api/v1/users?account=${account}`, {\r\n        \"method\": \"GET\",\r\n        \"headers\": {\r\n          \"content-type\": \"application/json\"\r\n        }\r\n      })\r\n      .then(response => {\r\n        response.json().then(userData => {\r\n          this.setUserData(userData);\r\n        })\r\n        .catch(err => {\r\n          console.log(err)\r\n        })\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      });\r\n    },\r\n    //\r\n    // 드롭박스 열려 있을 때, 영역 외 화면 클릭시 닫힘\r\n    //\r\n    onTouch() {\r\n      this.$eventBus.$emit('close-dropdonw','');\r\n    },\r\n    //\r\n    //  처음 접속한 유저에게 How To Play 모달 노출 \r\n    //\r\n    showHowtoAtFirst() {\r\n      if(!localStorage.isNewComer) {\r\n        this.isModal = true;\r\n        this.showHowto = true;\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    isDrawer(val) {\r\n      if (val) {\r\n        this.isModal = true;\r\n      } else if (!(this.showBonus | this.showReferral | this.showHowto)) {\r\n        this.isModal = false;\r\n      }\r\n    },\r\n    //\r\n    // 모달창 노출 시, 모달창 뒤의 배경화면 고정 \r\n    //\r\n    isModal(val) {\r\n      if(val) {\r\n        document.documentElement.style.overflow = 'hidden';\r\n        document.documentElement.style.position = 'fixed';\r\n        document.documentElement.style.height = '100vh';\r\n        document.documentElement.style.width = '100vw';\r\n      } else {\r\n        document.documentElement.style.position = '';\r\n        document.documentElement.style.overflow = 'auto';\r\n        document.documentElement.style.height = '100%';\r\n        document.documentElement.style.width = '100%';\r\n      }\r\n    }\r\n  },\r\n  /**\r\n   * Components\r\n   */\r\n  components: {\r\n    'g-drawer': Drawer,\r\n    'g-appbar': Appbar,\r\n    'modal-bonus': Bonus,\r\n    'modal-referral': Referral,\r\n    'modal-howto': Howto,\r\n  }\r\n}\r\n",{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\r\n  <div id=\"app\" @click=\"onTouch\">\r\n    <audio id=\"music\" loop @canplaythrough=\"playMusic\" preload=\"auto\">\r\n      <source :src=\"musicSrc\" preload=\"auto\">\r\n    </audio>\r\n\r\n    <modal-bonus v-if=\"showBonus\" @close-bonus=\"closeModal\" />\r\n    <modal-referral v-if=\"showReferral\" @close-referral=\"closeModal\" />\r\n    <modal-howto v-if=\"showHowto\" @close-howto=\"closeModal\" />\r\n\r\n    <g-appbar ref=\"test\" @login=\"login\" @logout=\"logout\" @lang-change=\"changeLang($event)\" :is-lang-changed=\"isLangChanged\"\r\n      @token-changed=\"setToken()\" :is-token-changed=\"isTokenChanged\" @show-modal=\"showModal\" />\r\n    <aside id=\"drawer\" :class=\"classDrawer\">\r\n      <g-drawer @close-drawer=\"closeDrawer\" @show-modal=\"showModal\" @music-state-change=\"playMusic\"\r\n        @token-changed=\"setToken()\" :is-token-changed=\"isTokenChanged\" :is-lang-changed=\"isLangChanged\"\r\n        @lang-change=\"changeLang($event)\" @from-sicbo-to-elsewhere=\"onResize()\" @logout=\"logout\" @login=\"login\" />\r\n    </aside>\r\n    <div id=\"drawer-scrim\" :class=\"classDrawerScrim\" @click=\"closeDrawer\"></div>\r\n\r\n    <div id=\"contents\" :class=\"classContents\">\r\n      <div :class=\"classPadding\"></div>\r\n      <transition name=\"fade\" mode=\"out-in\">\r\n        <router-view :is-lang-changed=\"isLangChanged\" />\r\n      </transition>\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { flatMap } from 'rxjs/operators'\r\nimport { mapState, mapMutations } from 'vuex';\r\nimport Drawer from './components/Drawer.vue';\r\nimport Appbar from './components/Appbar.vue';\r\nimport Bonus from './components/Bonus.vue';\r\nimport Referral from './components/Referral.vue';\r\nimport Howto from './components/HowToModal.vue';\r\nimport { throwError } from 'rxjs';\r\n\r\nconst LANDING_STATIC = 1284;\r\nconst LANDING_MOBILE = 984;\r\nconst SICBO_MOBILE_WIDTH = 1024;\r\nconst SICBO_MOBILE_HEIGHT = 680;\r\n\r\nexport default {\r\n  /**\r\n   * Data\r\n   */\r\n  data() {\r\n    return {\r\n      initialized: false,\r\n      musicSrc: '/music/music.mp3',\r\n      isTokenChanged: false,\r\n      isLangChanged: false,\r\n      showBonus: false,\r\n      showReferral: false,\r\n      showHowto: false,\r\n      isModal: false,\r\n    }\r\n  },\r\n  /**\r\n   * Computed\r\n   */\r\n  computed: mapState({\r\n    isDrawer(state) {\r\n      return state.common.drawerMode !== 'static' && state.common.drawerState === 'open';\r\n    },\r\n    /**\r\n     * Contents 패딩 영역의 css class\r\n     */\r\n    classPadding(state) {\r\n      if (state.common.drawerMode === 'static') return 'padding static';\r\n      if (state.common.drawerState === 'open') {\r\n        return 'padding-close';\r\n      }\r\n      return 'padding-close';\r\n    },\r\n    /**\r\n     * Navigation drawer의 css class\r\n     */\r\n    classDrawer(state) {\r\n      if (state.common.drawerMode === 'static') return 'static';\r\n\r\n      if (state.common.drawerMode === 'overlap' && state.common.appbarMode === 'mobile') {\r\n        if (state.common.drawerState === 'close') {\r\n          if (!this.initialized) {\r\n            this.initialized = true;\r\n            return 'over-tall close-without-ani';\r\n          }\r\n          \r\n          return 'over-tall close';\r\n        } else if (state.common.drawerState === 'close-without-ani') {\r\n          return 'over-tall close-without-ani';  \r\n        }\r\n        return 'over-tall open';\r\n      }\r\n      \r\n      if (state.common.drawerState === 'close') {\r\n        return 'over-short close';  \r\n      } else if (state.common.drawerState === 'close-without-ani') {\r\n        return 'over-short close-without-ani'; \r\n      }\r\n      return 'over-short open';  \r\n    },\r\n    /**\r\n     * Navigation drawer의 뒤에 깔리는 반투명 div의 css class\r\n     */\r\n    classDrawerScrim(state) {\r\n      if (state.common.drawerMode === 'static') {\r\n        document.body.style.overflow = '';\r\n        return '';\r\n      }\r\n\r\n      if (state.common.drawerState === 'open') {\r\n        document.body.style.overflow = 'hidden';\r\n        return 'open';\r\n      }\r\n\r\n      document.body.style.overflow = '';\r\n      return 'close';\r\n    },\r\n    /**\r\n     * Contents 영역의 css class\r\n     */\r\n    classContents(state) {\r\n      if (state.common.drawerMode === 'static') return `pc`;\r\n      if (state.common.drawerState === 'open') {\r\n        return `${state.common.appbarMode}`;  \r\n      }\r\n      return `${state.common.appbarMode}`;\r\n    },\r\n    /**\r\n     * \r\n     */\r\n    userName(state) {\r\n      if (!state.common.account.name) {\r\n        return ''\r\n      }\r\n      return state.common.account.name;\r\n    }\r\n  }),\r\n  /**\r\n   * Created\r\n   */\r\n  created() {\r\n    if (this.$route.query.ref && this.$route.query.ref.length <= 12) {\r\n      localStorage.setItem('GuangGame.Referral', this.$route.query.ref);\r\n    }\r\n    window.addEventListener('resize', this.onResize);\r\n    this.showHowtoAtFirst(); //\r\n  },\r\n  /**\r\n   * Destroy\r\n   */\r\n  destroyed() {\r\n    window.removeEventListener('resize', this.onResize);\r\n  },\r\n  /**\r\n   * Mounted\r\n   */\r\n  mounted () {\r\n    this.onResize();\r\n    this.login();\r\n  },\r\n  /**\r\n   * Method\r\n   */\r\n  methods: {\r\n    /**\r\n     * vuex store\r\n     */\r\n    ...mapMutations([\r\n      'setAppbarMode',\r\n      'setDrawerState',\r\n      'setDrawerMode',\r\n      'setAccount',\r\n      'setEosBalance',\r\n      'setTazBalance',\r\n      'setTazchipBalance',\r\n      'setUserData'\r\n    ]),\r\n    /**\r\n     * 브라우져 화면 크기에 변화가 생겼을 때 호출 되는 이벤트 콜백 함수\r\n     */\r\n    onResize() {\r\n      if (this.$route.name === 'sicbo') {\r\n        if (window.innerWidth < SICBO_MOBILE_WIDTH || window.innerHeight < SICBO_MOBILE_HEIGHT) {\r\n          this.setAppbarMode('mobile');\r\n        } else {\r\n          this.setAppbarMode('pc');\r\n        }\r\n        this.setDrawerMode('overlap');\r\n        this.setDrawerState('close');\r\n        this.$eventBus.$emit('resize', {w: window.innerWidth, h: window.innerHeight});\r\n      } else {\r\n        if (window.innerWidth >= LANDING_STATIC) {\r\n          this.setAppbarMode('pc');\r\n          this.setDrawerMode('static');\r\n          this.setDrawerState('open');\r\n        } else if (window.innerWidth >= LANDING_MOBILE) {\r\n          this.setAppbarMode('pc');\r\n          this.setDrawerMode('overlap');\r\n          this.setDrawerState('close');\r\n        } else {\r\n          this.setAppbarMode('mobile');\r\n          this.setDrawerMode('overlap');\r\n          this.setDrawerState('close');\r\n        }\r\n      }\r\n    },\r\n    /**\r\n     * Navigation drawer을 닫는다.\r\n     */\r\n    closeDrawer() {\r\n      this.setDrawerState('close');\r\n    },\r\n    changeLang(langToChange) {\r\n      console.log(langToChange);\r\n      if (this.$i18n.locale !== langToChange) {\r\n        if (!this.$loadedLanguages[langToChange]) {\r\n          return import(/* webpackChunkName: \"lang-[request]\" */ `@/languages/${langToChange}`).then(msgs => {\r\n            this.$i18n.setLocaleMessage(langToChange, msgs.default)\r\n            this.$loadedLanguages[langToChange] = msgs;\r\n            this.$i18n.locale = langToChange;\r\n            localStorage.setItem('GuangGame.Language', langToChange);\r\n            this.isLangChanged = !this.isLangChanged;\r\n          })\r\n        }\r\n        this.$i18n.locale = langToChange;\r\n        localStorage.setItem('GuangGame.Language',langToChange)\r\n        this.isLangChanged = !this.isLangChanged;\r\n      }\r\n    },\r\n    /**\r\n     * Login\r\n     */\r\n    login() {\r\n      this.$chain.connect().pipe(\r\n        flatMap(connected => {\r\n          if (connected) {\r\n            return this.$chain.login()\r\n          }\r\n          return throwError(new Error('No scatter'));\r\n        })\r\n      ).subscribe(\r\n        account => {\r\n          this.setAccount(account);\r\n\r\n          this.$chain.getEosBalance(account.name).subscribe(\r\n            eosBalance => {\r\n              if (eosBalance.length > 0) {\r\n                const token = eosBalance[0].split(' ');\r\n                this.setEosBalance(Number.parseFloat(token[0]));\r\n              } else {\r\n                this.setEosBalance(0);\r\n              }\r\n            },\r\n            error => console.error(error)\r\n          );\r\n\r\n          this.$chain.getBalance('taztokenbase', account.name, 'TAZ').subscribe(\r\n            tazBalance => {\r\n              if (tazBalance.length > 0) {\r\n                const token = tazBalance[0].split(' ');\r\n                this.setTazBalance(Number.parseFloat(token[0]));\r\n              } else {\r\n                this.setTazBalance(0);\r\n              }\r\n            },\r\n            error => console.error(error)\r\n          );\r\n\r\n          this.$chain.getBalance('taztokenbase', account.name, 'TAZCHIP').subscribe(\r\n            tazchipBalance => {\r\n              if (tazchipBalance.length > 0) {\r\n                const token = tazchipBalance[0].split(' ');\r\n                this.setTazchipBalance(Number.parseFloat(token[0]));\r\n              } else {\r\n                this.setTazchipBalance(0);\r\n              }\r\n            },\r\n            error => console.error(error)\r\n          );\r\n\r\n          this.$eventBus.$emit('login');\r\n          this.$ws.connectprivateChannel(account.name);\r\n          this.fetchUserData(account.name);\r\n        },\r\n        error => {\r\n          // user rejected the provision of an Identity\r\n          // No scatter\r\n          console.error(error.message);\r\n        }\r\n      )\r\n    },\r\n    /**\r\n     * Logout\r\n     */\r\n    logout() {\r\n      this.setAccount({});\r\n      this.setEosBalance(0);\r\n      this.setTazBalance(0);\r\n      this.setTazchipBalance(0);\r\n      this.$eventBus.$emit('logout');\r\n      this.setUserData({\r\n        account: '',\r\n        vip: 0,\r\n        accumulated_bet: 0,\r\n        accumulated_prize: 0,\r\n        staked: 0,\r\n        unstaking: 0,\r\n        unstaking_requested: 0,\r\n        created: '',\r\n        updated: '',\r\n        signup_reward: 0\r\n      });\r\n    },\r\n    //\r\n    // 배경음 재생\r\n    //\r\n    playMusic() {\r\n      const isOn = localStorage.getItem('GuangGame.music');\r\n      const music = document.getElementById('music')\r\n      if(isOn === 'on') {\r\n        music.play();\r\n      } else {\r\n        music.pause();\r\n      }\r\n    },\r\n    //\r\n    // 다른 토큰이 선택됐는지 여부 확인\r\n    //\r\n    setToken() {\r\n      this.isTokenChanged = !this.isTokenChanged;\r\n    },\r\n    //\r\n    // 모달창 열림\r\n    //\r\n    showModal(target) {\r\n      this.setDrawerState('close');\r\n      this.isModal = true;\r\n      if(target === 'bonus') {\r\n        this.showBonus = true;\r\n      } else if(target === 'referral') {\r\n        this.showReferral = true;\r\n      } else {\r\n        this.showHowto = true;\r\n      }\r\n    },\r\n    //\r\n    // 모달창 닫음\r\n    //\r\n    closeModal() {\r\n      this.isModal = false;\r\n      this.showBonus = false;\r\n      this.showReferral = false;\r\n      this.showHowto = false;\r\n    },\r\n    /**\r\n     * 서버로부터 사용자 정보를 조회한다.\r\n     */   \r\n    fetchUserData(account) {\r\n      fetch(`${this.$REST_API_SERVER}/api/v1/users?account=${account}`, {\r\n        \"method\": \"GET\",\r\n        \"headers\": {\r\n          \"content-type\": \"application/json\"\r\n        }\r\n      })\r\n      .then(response => {\r\n        response.json().then(userData => {\r\n          this.setUserData(userData);\r\n        })\r\n        .catch(err => {\r\n          console.log(err)\r\n        })\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      });\r\n    },\r\n    //\r\n    // 드롭박스 열려 있을 때, 영역 외 화면 클릭시 닫힘\r\n    //\r\n    onTouch() {\r\n      this.$eventBus.$emit('close-dropdonw','');\r\n    },\r\n    //\r\n    //  처음 접속한 유저에게 How To Play 모달 노출 \r\n    //\r\n    showHowtoAtFirst() {\r\n      if(!localStorage.isNewComer) {\r\n        this.isModal = true;\r\n        this.showHowto = true;\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    isDrawer(val) {\r\n      if (val) {\r\n        this.isModal = true;\r\n      } else if (!(this.showBonus | this.showReferral | this.showHowto)) {\r\n        this.isModal = false;\r\n      }\r\n    },\r\n    //\r\n    // 모달창 노출 시, 모달창 뒤의 배경화면 고정 \r\n    //\r\n    isModal(val) {\r\n      if(val) {\r\n        document.documentElement.style.overflow = 'hidden';\r\n        document.documentElement.style.position = 'fixed';\r\n        document.documentElement.style.height = '100vh';\r\n        document.documentElement.style.width = '100vw';\r\n      } else {\r\n        document.documentElement.style.position = '';\r\n        document.documentElement.style.overflow = 'auto';\r\n        document.documentElement.style.height = '100%';\r\n        document.documentElement.style.width = '100%';\r\n      }\r\n    }\r\n  },\r\n  /**\r\n   * Components\r\n   */\r\n  components: {\r\n    'g-drawer': Drawer,\r\n    'g-appbar': Appbar,\r\n    'modal-bonus': Bonus,\r\n    'modal-referral': Referral,\r\n    'modal-howto': Howto,\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n@import \"./scss/flex.scss\";\r\n@import url('https://fonts.googleapis.com/css?family=Noto+Sans+KR:300,400,500,700|Noto+Sans+SC:400,500,700|Roboto:300,400,500,700&display=swap');\r\n\r\nhtml,\r\nbody {\r\n  font-family: 'Roboto', 'Noto Sans KR', 'Noto Sans SC', sans-serif;\r\n  margin: 0px;\r\n  padding: 0px;\r\n  min-width: 360px;\r\n  background: #0E1526;\r\n  overflow:auto; \r\n}\r\n\r\n#app {\r\n  display: block;\r\n  -webkit-font-smoothing: antialiased;\r\n  -moz-osx-font-smoothing: grayscale;\r\n\r\n  -moz-user-select: none;\r\n  -khtml-user-select: none;\r\n  -webkit-user-select: none;\r\n  -ms-user-select: none;\r\n  user-select: none;\r\n  color: black;\r\n}\r\n\r\n</style>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import \"./scss/flex.scss\";\r\n@import \"./scss/variable.scss\";\r\n\r\n$drawer-width: 300px;\r\n\r\n#drawer {\r\n  position: fixed;\r\n  top: 0px;\r\n  left: 0px;\r\n  min-width: $drawer-width;\r\n  height: 100%;\r\n\r\n  background: linear-gradient(180deg, #3C1708 0%, #130703 100%);\r\n\r\n  transition-property: all;\r\n  transition-duration: 1s;\r\n  transition-timing-function: ease;\r\n\r\n  &.over-tall {\r\n    z-index: 300;\r\n    overflow: auto;\r\n    &.open {\r\n      left: 0px;\r\n    }\r\n\r\n    &.close {\r\n      left: $drawer-width * -1;\r\n    }\r\n\r\n    &.close-without-ani {\r\n      transition-duration: 0s;\r\n      left: $drawer-width * -1;\r\n    }\r\n  }\r\n\r\n  &.over-short {\r\n    z-index: 100;\r\n\r\n    &.open {\r\n      left: 0px;\r\n    }\r\n\r\n    &.close {\r\n      left: $drawer-width * -1;\r\n    }\r\n\r\n    &.close-without-ani {\r\n      transition-duration: 0s;\r\n      left: $drawer-width * -1;\r\n    }\r\n  }\r\n\r\n  &.static {\r\n    position: absolute;\r\n    z-index: 100;\r\n    transition-duration: 1s;\r\n  }\r\n}\r\n\r\n#drawer-scrim {\r\n  position: fixed;\r\n  background: rgba(0, 0, 0, 0.3);\r\n  top: 0px;\r\n  left: 0px;\r\n  z-index: 90;\r\n  height: 100%;\r\n  min-height: 100vh;\r\n  width: 0px;\r\n  transition-duration: 0s;\r\n\r\n  &.open {\r\n    width: 100%;\r\n    opacity: 1.0;\r\n    transition-property: all;\r\n    transition-duration: 1s;\r\n    transition-timing-function: ease;\r\n  }\r\n\r\n  &.close {\r\n    transition-property: all;\r\n    transition-duration: 1s;\r\n    transition-timing-function: ease;\r\n    opacity: 0.0;\r\n  }\r\n}\r\n\r\naudio {\r\n  width: 300px;\r\n  height: 300px;\r\n  position: fixed;\r\n  left: 0;\r\n  bottom: 0\r\n}\r\n\r\n#contents {\r\n  @extend .flex;\r\n  position: absolute;\r\n  left: 0px;\r\n  top: 0px;\r\n  z-index: 0;\r\n  width: 100%;\r\n  transition-property: all;\r\n  transition-duration: 1s;\r\n  transition-timing-function: ease;\r\n\r\n  &.pc {\r\n    padding-top: 68px;\r\n  }\r\n\r\n  &.mobile {\r\n    padding-top: 60px;\r\n  }\r\n\r\n  .padding {\r\n    min-width: 300px;\r\n    transition-property: all;\r\n    transition-duration: 0s;\r\n    transition-timing-function: ease;\r\n\r\n    &.static {\r\n      transition-duration: 1s;\r\n      background: #130703;\r\n    }\r\n  }\r\n\r\n  .padding-close {\r\n    min-width: 0px;\r\n    transition-property: all;\r\n    transition-timing-function: ease;\r\n  }\r\n\r\n  .fade-enter-active {\r\n    transition: opacity 0.4s;\r\n  }\r\n\r\n  .fade-enter {\r\n    opacity: 0;\r\n  }\r\n}\r\n\r\n</style>\r\n"]}]}